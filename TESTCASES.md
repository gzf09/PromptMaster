# PromptMaster 功能测试用例

> 测试环境: http://47.107.238.118
> 前置操作: 每次测试前建议清除浏览器 localStorage（DevTools → Application → Clear）以获得干净状态

---

## 1. 登录/登出

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 1.1 | 打开首页，输入用户名 `Admin User`，密码 `password`，点击登录 | 登录成功，显示主界面，出现 "Welcome back" toast |
| 1.2 | 输入错误密码，点击登录 | 登录失败，提示错误信息 |
| 1.3 | 登录后，点击侧边栏用户头像区域的「登出」按钮 | 返回登录页面，当前用户状态清除 |
| 1.4 | 刷新页面 | 由于 session 不持久化，应返回登录页 |

---

## 2. 用户管理（Admin）

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 2.1 | 以 Admin 登录 → 打开用户管理面板 | 显示已有用户列表（Admin User, Jane Doe） |
| 2.2 | 输入新用户名（如 "Test User"），选择角色 `user`，点击「添加」 | 用户列表新增 "Test User"，出现 toast 通知 |
| 2.3 | 再次添加同名用户 | 应允许添加（系统无同名校验） |
| 2.4 | 点击 "Test User" 旁的删除按钮 | 用户被删除，出现 toast，其提示词归属转移到当前 Admin |
| 2.5 | 尝试删除自己（Admin User） | 操作被拒绝，出现 "无法删除自己" 的 toast |
| 2.6 | 以普通用户（Jane Doe）登录 → 检查是否能看到用户管理入口 | 不应显示用户管理入口（仅 Admin 可见） |

---

## 3. 用户切换

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 3.1 | 以 Admin 登录 → 侧边栏切换到 Jane Doe | 当前用户变为 Jane Doe，出现切换成功 toast |
| 3.2 | 切换后查看提示词列表 | 应显示 Jane Doe 的提示词（非 Admin 的） |

---

## 4. 首次登录改密

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 4.1 | Admin 创建新用户（如 "New User"，默认密码 `123456`） | 创建成功 |
| 4.2 | 登出，以 "New User" / `123456` 登录 | 显示强制改密页面 |
| 4.3 | 输入新密码并确认 | 密码修改成功，进入主界面，出现 toast |
| 4.4 | 登出后使用新密码重新登录 | 正常登录，不再弹出改密页面 |
| 4.5 | 使用旧密码 `123456` 登录 | 登录失败 |

---

## 5. 提示词 CRUD

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 5.1 | 点击「新建提示词」按钮 | 打开编辑器，表单为空 |
| 5.2 | 不填标题，直接点「保存」 | 出现错误 toast，提示标题必填 |
| 5.3 | 填写标题、内容、选择分类、添加标签、设置可见性为 Private → 保存 | 提示词出现在列表中，出现成功 toast |
| 5.4 | 点击已有提示词的「编辑」按钮 | 编辑器打开，表单预填充已有数据 |
| 5.5 | 修改标题 → 保存 | 列表中该提示词标题更新，toast 显示已更新 |
| 5.6 | 点击提示词的「删除」按钮 | 提示词从列表中移除，toast 提示已删除 |
| 5.7 | 点击「复制」按钮 | 剪贴板写入提示词内容，toast 提示已复制 |

---

## 6. 分类管理

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 6.1 | 侧边栏底部输入新分类名（如 "AI Tools"），点击添加 | 侧边栏新增分类项，出现成功 toast |
| 6.2 | 再次添加同名分类（大小写不同，如 "ai tools"） | 出现 "分类已存在" 错误 toast |
| 6.3 | 点击自定义分类旁的删除按钮 | 分类被删除；归属该分类的提示词移至「其他」 |
| 6.4 | 删除当前选中的分类 | 分类删除后，视图自动切换回「全部」 |
| 6.5 | 系统默认分类（编程、写作等）不应有删除按钮 | 无法删除系统分类 |

---

## 7. 搜索/过滤

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 7.1 | 在搜索栏输入已有提示词的标题关键字 | 列表实时过滤，仅显示匹配的提示词 |
| 7.2 | 搜索标签关键字 | 匹配标签的提示词显示 |
| 7.3 | 搜索不存在的关键字 | 列表为空，显示 "0 prompts found" |
| 7.4 | 清空搜索栏 | 列表恢复全部显示 |
| 7.5 | 点击热门标签（Popular Tags 区域） | 搜索栏自动填入标签，列表过滤 |
| 7.6 | 再次点击同一个热门标签 | 搜索清除，恢复全部显示 |
| 7.7 | 侧边栏选择特定分类 | 仅显示该分类下的提示词 |

---

## 8. 收藏

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 8.1 | 点击提示词卡片上的收藏/星标按钮 | 图标变为已收藏状态 |
| 8.2 | 侧边栏点击「收藏」筛选 | 仅显示收藏的提示词 |
| 8.3 | 取消收藏（再次点击星标） | 图标恢复为未收藏状态 |
| 8.4 | 回到「收藏」筛选 | 已取消收藏的提示词不再显示 |

---

## 9. 可见性（公开/私有）

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 9.1 | 创建一个 Public 提示词 | 提示词创建成功 |
| 9.2 | 切换到「社区」视图 | Public 提示词在社区列表中可见 |
| 9.3 | 创建一个 Private 提示词 | 提示词创建成功 |
| 9.4 | 切换到「社区」视图 | Private 提示词不在社区列表中 |
| 9.5 | 以其他用户登录 → 查看「社区」 | 只能看到 Public 提示词 |
| 9.6 | 以其他用户登录 → 「全部」视图 | 看不到其他用户的 Private 提示词 |

---

## 10. 访客模式

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 10.1 | 在登录页点击「访客访问」 | 以 Guest 身份进入，自动跳转到社区视图 |
| 10.2 | 尝试点击「新建提示词」按钮 | 按钮不可见（Guest 无法创建） |
| 10.3 | 尝试收藏提示词 | 操作无效（Guest 无权限） |
| 10.4 | 尝试删除提示词 | 操作无效（Guest 无权限） |
| 10.5 | 查看社区中的 Public 提示词 | 可以正常查看、复制 |
| 10.6 | 查看侧边栏 | 无用户管理入口、无新建分类功能 |

---

## 11. 主题/语言切换

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 11.1 | 侧边栏切换暗色主题 | 页面背景变为深色，文字变为浅色 |
| 11.2 | 切回亮色主题 | 页面恢复亮色 |
| 11.3 | 刷新页面后重新登录 | 主题偏好保持（localStorage 持久化） |
| 11.4 | 切换语言为 English | 界面文案变为英文 |
| 11.5 | 切回中文 | 界面文案变为中文 |
| 11.6 | 刷新页面后重新登录 | 语言偏好保持 |

---

## 12. Toast 通知

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 12.1 | 执行登录操作 | 出现 success 类型 toast |
| 12.2 | 执行保存提示词 | 出现 success 类型 toast |
| 12.3 | 执行删除操作 | 出现 info 类型 toast |
| 12.4 | 触发错误（如空标题保存） | 出现 error 类型 toast |
| 12.5 | 等待数秒 | toast 自动消失 |
| 12.6 | 快速执行多个操作 | 多个 toast 叠加显示，各自独立消失 |

---

## 13. 数据持久化

| # | 测试步骤 | 预期结果 |
|---|---------|---------|
| 13.1 | 创建提示词 → 刷新页面 → 重新登录 | 提示词数据仍在 |
| 13.2 | 添加分类 → 刷新页面 → 重新登录 | 分类数据仍在 |
| 13.3 | 创建新用户 → 刷新页面 → 以新用户登录 | 用户数据仍在 |
| 13.4 | 切换主题/语言 → 刷新页面 | 偏好设置仍在 |

---

## 14. 可访问性验证（自动化）

| # | 验证方法 | 预期结果 |
|---|---------|---------|
| 14.1 | `curl -s -o /dev/null -w "%{http_code}" http://47.107.238.118/` | 返回 `200` |
| 14.2 | `curl -s http://47.107.238.118/ \| grep -c "script"` | 输出 ≥ 1（页面包含 JS 引用） |
